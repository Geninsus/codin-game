<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" href="css/interpreter.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,300,700' rel='stylesheet' type='text/css'>
  </head>
  <body>
    <div class="leftContainer container">
      <form onsubmit="return main();" action="#" method="post" class="dataForm">
        <textarea name="code" id="code" class="dataForm--code"></textarea><br>
        <input type="text" name="code" id="inputs" placeholder="Inputs:  1 6 42 8" class="dataForm--text dataForm--input"/><br>
        <input type="text" name="code" id="memory" placeholder="Memory:  0 1 null null null 32 12" class="dataForm--text dataForm--memory"/><br>
        <input type="submit" name="name" class="btn dataForm--submit" value="Envoyer">
      </form>
      <div class="command">
        <button onclick="Interpreter.prev();" type="button" name="button" class="btn command--btn btn__disabled" disabled>Prev</button>
        <button onclick="Interpreter.run();" type="button" name="button" class="btn command--btn btn__disabled" disabled>Run</button>
        <button onclick="Interpreter.next();" type="button" name="button" class="btn command--btn btn__disabled" disabled>Next</button>
      </div>
      <p id="errors" class="errors"></p>
    </div>
    <div class="rightContainer container">
      <p class="rightContainer--title">
        Outputs
      </p>
      <div id="outputs" class="rightContainer--outputs"><p></p></div>
      <p class="rightContainer--title">
        Memory
      </p>
      <div class="rightContainer--memory">
        <table class="rightContainer--memory--table">
          <tr id="rightContainer--memory--table--line" class="rightContainer--memory--table--line">

          </tr>
        </table>
      </div>
    </div>
    <script src="js/interpreter.js" charset="utf-8"></script>
    <script type="text/javascript">

    var DEBUG = 1;

    function main() {

      Memory.init(document.querySelector('#memory').value.split(/\s+/));
      Inputs.init(document.querySelector('#inputs').value.split(/\s+/));

      var memoryLine = document.querySelector('#rightContainer--memory--table--line');

      Memory.memory.forEach(function(elt, index) {
        memoryLine.innerHTML += '<td id="memoryElt' + index +'" class="rightContainer--memory--table--line--element">' + elt + '</td>';
      });

      document.querySelector('#errors').innerHTML = "";
      document.querySelector('#outputs').innerHTML = "";

      Interpreter.labels = {};
      Interpreter.codes = Interpreter.parser(document.querySelector('#code').value);
      Interpreter.i = 0;
      var commands = document.querySelectorAll('.command--btn');
      for (var i = 0; i < commands.length; i++) {
        commands[i].className = "btn command--btn";
        commands[i].disabled = false;
      }
      return false;
   }
    </script>
  </body>
</html>
